10.2 Web Indexing
199
D1: java resource java class
Key
java
resource
class
Map
Reduce
Value
(D1, 2)
(D1, 1)
(D1, 1)
D2: java travel resource
Built in Shufﬂe and Sort: aggregate values by keys
Key
java
travel
resource
Value
(D2, 1)
(D2, 1)
(D2, 1)
Key
java
resource
class
travel
Value
{(D1, 2), (D2, 1)}
{(D1, 1), (D2, 1)}
{(D1, 1)}
{(D2, 1)}
D3: …
Figure 10.5
Using MapReduce to create an inverted index.
Algorithm 10.1
Pseudocode for inverted index construction
function MAP(docid n, doc d)
H ← new ASSOCIATIVEARRAY
for term t ∈ d do
H[t] ← H[t] + 1
end for
for t ∈ H do
EMIT(t, [n, H[t]])
end for
end function
function REDUCE(term t, postings [(a1, f1), (a2, f2), . . .])
P ← new LIST
for all (a, f ) do
APPEND(P , (a, f ))
end for
SORT(P )
EMIT(t, P)
end function
